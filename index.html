<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>BookKaro - Staff Dashboard</title>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, onSnapshot, doc, updateDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAL-LDI6qvDPqVWNL_tNb53D7kacbpAlAw",
            authDomain: "bookkaro-f549a.firebaseapp.com",
            projectId: "bookkaro-f549a",
            storageBucket: "bookkaro-f549a.firebasestorage.app",
            messagingSenderId: "1067243117950",
            appId: "1:1067243117950:web:c7682b0aca89d0c0a0272f"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        onSnapshot(collection(db, "bookings"), (snapshot) => {
            const list = document.getElementById('requestList');
            list.innerHTML = "";
            snapshot.forEach((d) => {
                const data = d.data();
                const item = document.createElement('div');
                item.style.border = "1px solid #ddd";
                item.style.padding = "15px";
                item.style.margin = "10px 0";
                item.style.borderRadius = "8px";
                item.innerHTML = `
                    <p><strong>Customer:</strong> ${data.customerName} | <strong>Stay:</strong> ${data.propertyType}</p>
                    <p>Status: <span style="font-weight:bold">${data.status}</span></p>
                    <input type="text" id="alt-${d.id}" placeholder="Enter alternate options if rejecting" value="${data.alternateOptions || ''}" style="width:70%; padding:5px;">
                    <button onclick="update('${d.id}', 'Approved')" style="background:#28a745; color:white;">Approve</button>
                    <button onclick="update('${d.id}', 'Rejected')" style="background:#dc3545; color:white;">Reject</button>
                `;
                list.appendChild(item);
            });
        });

        window.update = async (id, status) => {
            const altValue = document.getElementById(`alt-${id}`).value;
            await updateDoc(doc(db, "bookings", id), { status: status, alternateOptions: altValue });
        };
    </script>
</head>
<body>
    <h1>BookKaro Staff Portal</h1>
    <p><strong>Login Credentials:</strong> admin / bookkaro2025</p> <div id="requestList">Waiting for incoming bookings...</div>
</body>
</html>
